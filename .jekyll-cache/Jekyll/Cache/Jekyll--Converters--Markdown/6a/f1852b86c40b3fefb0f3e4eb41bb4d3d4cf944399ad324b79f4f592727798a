I"ª<h1 id="regla-de-traspaso-segunda-parte">Regla de Traspaso Segunda Parte</h1>

<p>En el post anterior comenzamos a dise√±ar una regla de traspaso que nos sirva para todos los traspasos que tengamos que hacer en el libro diario. Inicialmente conseguirmos que la regla se disparara y que imprimiera la palabra Partida.</p>

<p>Ahora explicaremos como dise√±ar la regla para que haga todo lo que necesitamos.</p>

<p>Si observa la regla de traspaso que traemos ac√° con el comienzo de la soluci√≥n ver√° que estamos usando en el lado derecho de la regla algunas palabras que comienzan con un signo de interrogaci√≥n y que fueron colocadas en el lado izquierdo de la regla. Esas palabras son variables y funcionan como naipes del tipo comodines, capturando el valor que traiga el fact en el lado izquierdo de la reglas. Por esa raz√≥n:</p>
<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />?desde almacenar√° el nombre de la cuenta desde donde desea realizar el traspaso.</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />?hacia almacenar√° el nombre de la cuenta hacia donde se desea realizar el traspaso</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />?monto almacenar√° el monto que se quiere trasnferir desde la cuenta ?desde hacia la cuenta ?hacia</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />?dia, ?mes y ?ano almacenan la fecha de la transacci√≥n</li>
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" checked="checked" />?partida almacena el n√∫mero de la partida en la que se realizar√° la transacci√≥n.</li>
</ul>

<p>En el lado derecho ya no usamos <strong>printout t</strong> pues ya disponemos de una regla para poner en la pantalla las partidas. Esa regla la activaremos assertando en el lado derecho de la regla de traspasos el fact partida. Ese fact es lo √∫nico que se necesita para que se muestre el encabezado y el pie de las partidas‚Ä¶, pero no el cuerpo.</p>

<p>En el fact partida usamos las variables vistas arriba con los valores que est√°s lograron capturar en el lado izquierdo de la regla.</p>

<figure class="highlight"><pre><code class="language-clips" data-lang="clips">(defrule traspaso
  (declare (salience 10000))
  (traspaso (desde ?desde) (hacia ?hacia) (monto ?monto) (dia ?dia) (mes ?mes) (ano ?ano) (partida ?partida))
  =&gt;
  ( assert (partida  (glosa (str-cat "Traspaso desde cuenta " ?desde " hacia cuenta " ?hacia " por un monto de " ?monto"."))  (numero ?partida) (dia ?dia) (mes ?mes) (ano ?ano) ))</code></pre></figure>

<p>La regla est√° incompleta pues faltar√° el cuerpo de la partida, pero ya sabemos que eso lo pueden generar los facts de cargo y abono los cuales, a su vez, necesitan que las cuentas sean creadas.</p>

<p>Note que estamos usando una nueva funci√≥n que junta variables con texto. Esa funci√≥n se usa:</p>

<p>(str-cat ‚Äútext‚Äù ?variable1 ‚Äú texto ‚Äú ?variable‚Äù)</p>

<p>Observe que los par√©ntesis rodean al nombre de la funci√≥n: str-cat y a sus contenidos. Los contenidos de una funci√≥n se llaman argumentos.</p>

<figure class="highlight"><pre><code class="language-clips" data-lang="clips">(defrule traspaso
  (declare (salience 10000))
  (traspaso (desde ?desde) (hacia ?hacia) (monto ?monto) (dia ?dia) (mes ?mes) (ano ?ano) (partida ?partida))
  =&gt;
  ( assert (partida  (glosa (str-cat "Traspaso desde cuenta " ?desde " hacia cuenta " ?hacia " por un monto de " ?monto"."))  (numero ?partida) (dia ?dia) (mes ?mes) (ano ?ano) ))
  ( assert (cuenta (nombre ?desde) (debe 0)))
  ( assert (cuenta (nombre ?hacia) (debe 0)))
  ( assert (cargo (partida ?partida) (cuenta ?hacia)  (monto ?monto)))
  ( assert (abono (partida ?partida) (cuenta ?desde)  (monto ?monto)))

);


(defrule libro-diario
  =&gt;
  (assert (traspaso (desde caja) (hacia banco-estado) (monto 100) (dia 1) (mes enero) (ano 2021) (partida 2)))
)</code></pre></figure>

<p>Con todo estos facts tendremos la partida con todas sus secciones completas: encabezado, cuerpo y pie.</p>

<p>Hay un detalle adicional y es que en el libro diario debe colocarse partida 2 para que no se mezcle con la partida 1 que corresponde al asiento inicial.</p>

<figure class="highlight"><pre><code class="language-clips" data-lang="clips">(defrule libro-diario
  =&gt; 
  (assert (traspaso (desde caja) (hacia banco-estado) (monto 100) (dia 1) (mes enero) (ano 2021) (partida 2)))
)</code></pre></figure>

<p>Clique aqui para bajar el archivo <a href="/traspaso-2.clp">traspaso-2.clp</a>
Use abductor para generar contabilidad online <a href="http://abductor.necios.cl/">Abductor</a></p>

<p>Cuando suba traspaso-2.clp al abductor¬Æ ver√° que sigue apareciendo el asiento inicial ‚ÄúPor inicio de Operaciones‚Äù y que ahora aparece la partida 2.</p>

<figure class="highlight"><pre><code class="language-clips" data-lang="clips"> Partida 1

---------------------------------------------------------------

2000000......................caja

................. 2000000....capital-social

---------------------------------------------------------------

( 1 enero 2020 )

Por Inicio de Operaciones.

Partida 2

---------------------------------------------------------------

................. 100....caja

100......................banco-estado

---------------------------------------------------------------

( 1 enero 2021 )

Por Traspaso desde cuenta caja hacia cuenta banco-estado por un monto de 100. </code></pre></figure>

<p>Espero que le haya gustado mi soluci√≥n!</p>

<p>Pero antes de irse a descansar, ll√©vese una reflexi√≥n te√≥rica de contabilidad:</p>

<ol>
  <li>Qu√© significa un traspaso entre cuentas?</li>
  <li>Qu√© cuenta se carga en un traspaso, la de origen o la de destino?</li>
  <li>Qu√© pasa si las dos cuentas son del mismo grupo (por ejemplo, dos cuentas de activo)</li>
  <li>A qu√© grupo pertenecen las cuentas de caja y banco-estado?</li>
  <li>Las cuentas de caja y banco estado tienen el mismo tipo de saldo, cu√°l es?</li>
  <li>Si el el saldo de las cuentas de caja y banco-estado fuese deudor, d√≥nde se anotar√≠a; en el lado izquiedo DEBE o en lado derecho HABER.</li>
  <li>Qu√© significa que la cuenta de caja tenga saldo positivo</li>
  <li>Qu√© significa que la cuenta de caja tenga saldo negativo (cree que eso es cierto, que la caja tenga saldo negativo es raro, no?)</li>
</ol>

<p>Nos vemos en el pr√≥ximo Post para intentar explicar algo de todo este embrollo, Ud. puede buscar las respuestas en la Internet. Una pregunta t√≠pica es ‚ÄúQu√© tipo de cuenta es Caja‚Äù.</p>
:ET